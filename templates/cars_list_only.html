{% extends "base.html" %}
{% block content %}

<div class="dashboard-container">
    <div class="cars-container">
        <!-- En-tête avec titre et compteur -->
        <div class="cars-header">
            <h1 class="cars-title">
                <i class="fas fa-car"></i> Voitures Disponibles
                <span class="cars-count">{{ cars|length }}</span>
            </h1>
        </div>

{% if cars %}
<div class="car-grid">
    {% for car in cars %}
    <div class="car-card">
            {% set car_image_url = car.image_url %}
            {% if not car_image_url %}
                {% if car.make|lower == 'mercedes' %}
                    {% set car_image_url = 'https://images.unsplash.com/photo-1553440569-bcc63803a83d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80' %}
                {% elif car.make|lower == 'bmw' %}
                    {% set car_image_url = 'https://images.unsplash.com/photo-1555215695-3004980ad54e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80' %}
                {% elif car.make|lower == 'audi' %}
                    {% set car_image_url = 'https://images.unsplash.com/photo-1603584173870-7f23fdae1b7a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80' %}
                {% elif car.make|lower == 'toyota' %}
                    {% set car_image_url = 'https://images.unsplash.com/photo-1559416523-140ddc3d238c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80' %}
                {% elif car.make|lower == 'honda' %}
                    {% set car_image_url = 'https://images.unsplash.com/photo-1609521263047-f8f205293f24?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80' %}
                {% elif car.make|lower == 'ford' %}
                    {% set car_image_url = 'https://images.unsplash.com/photo-1551830820-330a71b99659?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80' %}
                {% elif car.make|lower == 'volkswagen' %}
                    {% set car_image_url = 'https://images.unsplash.com/photo-1541899481282-d53bffe3c35d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80' %}
                {% else %}
                    {% set car_image_url = 'https://images.unsplash.com/photo-1552519507-da3b142c6e3d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80' %}
                {% endif %}
            {% endif %}
            <div class="car-image" style="background-image: url('{{ car_image_url }}'); background-position: center center;">
                <div class="car-status available">{{ car.status|capitalize }}</div>
            </div>
            <div class="car-info">
                <h3 class="car-title">{{ car.make }} {{ car.model }}</h3>
                <p class="car-subtitle">{{ car.year }} • {{ car.registration_number }}</p>
                
                <div class="car-details">
                    <div class="car-detail-item">
                        <span class="car-detail-label"><i class="fas fa-calendar-alt"></i> Année</span>
                        <span>{{ car.year }}</span>
                    </div>
                    <div class="car-detail-item">
                        <span class="car-detail-label"><i class="fas fa-id-card"></i> Immatriculation</span>
                        <span>{{ car.registration_number }}</span>
                    </div>
                    <div class="car-detail-item">
                        <span class="car-detail-label"><i class="fas fa-check-circle"></i> Statut</span>
                        <span>{{ car.status|capitalize }}</span>
                    </div>
                </div>
                
                <div class="car-price">
                    {{ "%.2f"|format(car.daily_rate) }} €<span class="car-price-unit">/jour</span>
                </div>
                
                {% if session.user_id and session.role == 'manager' %}
                <div class="mt-3">
                    <a href="{{ url_for('edit_car', car_id=car._id) }}" class="btn btn-sm btn-warning"><i class="fas fa-edit"></i> Modifier</a>
                    <a href="{{ url_for('new_reservation') }}" class="btn btn-sm btn-primary"><i class="fas fa-calendar-plus"></i> Réserver</a>
                </div>
                {% endif %}
                
                <!-- Boutons d'action -->
                <div class="car-actions">
                    <a href="#" class="car-btn car-btn-primary">
                        <i class="fas fa-info-circle"></i> Détails
                    </a>
                    <a href="#" class="car-btn car-btn-secondary">
                        <i class="fas fa-calendar-alt"></i> Réserver
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-cars">
    <i class="fas fa-car"></i>
    <p>Aucune voiture disponible pour le moment.</p>
    <p>Veuillez revenir ultérieurement ou contacter l'agence.</p>
</div>
{% endif %}
    </div>
</div>

{% endblock %}
